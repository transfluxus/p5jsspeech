<!DOCTYPE HTML>
<html>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.4.5/p5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.4.5/addons/p5.dom.js"></script>
    <script type="text/javascript" src="p5.js-speech/lib/p5.speech.js"></script>
    <script type="text/javascript" src="words.js"></script>
    <script type="text/javascript" src="grammatic.js"></script>
    <script type="text/javascript" src="filter.js"></script>
    <script type="text/javascript" src="action.js"> </script>
    <script>
    var myRec = new p5.SpeechRec(); // new P5.SpeechRec object
    myRec.continuous = true; // do continuous recognition
    myRec.interimResults = true; // allow partial recognition (faster, less accurate)

    function setup() {
        for(var w in words) {
            if (words.hasOwnProperty(w)) {
                console.log(w);
            }
        }
        // graphics stuff:
        createCanvas(800, 600);
        background(255);
        myRec.onResult = parseResult; // recognition callback
        myRec.start(); // start engine
    }

    function draw() {

    }

    function parseResult() {
        // recognition system will often append words into phrases.
        // so hack here is to only use the last word:
        var mostrecentword = myRec.resultString.split(' ').pop();

        console.log(mostrecentword);

        var filter = new Filter(grammatic);
        filter.grab_object(mostrecentword);
        if (words.hasOwnProperty(mostrecentword)) {
            console.log("Found: "+mostrecentword+ " "+words[mostrecentword]);
            drawObject(words[mostrecentword]);
        }

    }
</script>
</head>
<body>
</body>
</html>
